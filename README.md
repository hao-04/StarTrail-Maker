# StarTrail Maker ⭐ 星轨视频生成器

将普通星空延时摄影视频转化为星轨效果视频的桌面工具。支持轨迹渐暗衰减、亮度阈值过滤，有效去除飞机/卫星等杂物干扰。

![Python](https://img.shields.io/badge/Python-3.9%2B-blue)
![PyQt6](https://img.shields.io/badge/GUI-PyQt6-green)
![OpenCV](https://img.shields.io/badge/CV-OpenCV-orange)
![License](https://img.shields.io/badge/License-MIT-yellow)

## 功能特性

- **星轨叠加**：逐帧提取亮像素并合成为星轨视频
- **轨迹渐暗衰减**：旧轨迹随时间自然变暗，呈现彗尾拖尾效果
- **亮度阈值过滤**：自动过滤飞机、卫星、热像素等瞬态杂物
- **实时预览**：处理过程中实时显示当前效果
- **分辨率缩放**：可降低分辨率以加速处理或减少内存占用
- **随时取消**：支持中途停止并保存已处理部分

## 截图预览

> 运行程序后可在 GUI 界面中实时预览星轨合成效果。

## 算法说明

每帧处理分三步：

1. **轨迹衰减** — 轨迹层每帧乘以衰减系数（如 0.995），旧轨迹逐渐变暗。瞬态杂物因不会被后续帧持续增强，数秒后自然消退。
2. **亮度过滤** — 仅提取像素亮度超过阈值的部分（星星），忽略暗背景噪声和地面杂光。
3. **自然合成** — 背景取自当前帧（保持自然），星轨从轨迹层叠加上去。

| 参数         | 说明                                                |
| ------------ | --------------------------------------------------- |
| 轨迹衰减速度 | 控制旧轨迹变暗的速率，从"无衰减"到"快速衰减"共 5 档 |
| 亮度过滤阈值 | 仅亮度超过此值的像素进入轨迹层，0~150 共 6 档       |
| 分辨率缩放   | 25% / 50% / 75% / 100%，降低可提升速度              |

## 快速开始

### 环境要求

- Python 3.10+
- Windows / macOS / Linux

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行

```bash
python startrail_maker.py
```

### 使用步骤

1. 点击 **选择输入视频**，选择一段星空延时摄影视频
2. 点击 **选择导出路径**，指定输出文件位置
3. 根据需要调整 **轨迹衰减速度**、**亮度过滤阈值** 和 **分辨率缩放**
4. 点击 **开始处理**，等待完成即可

## 项目结构

```
├── startrail_maker.py   # 主程序（GUI + 处理逻辑）
├── requirements.txt     # Python 依赖
├── README.md
├── LICENSE
└── .gitignore
```

## 许可证

[MIT License](LICENSE)
